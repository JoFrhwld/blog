{
  "hash": "fc9a3d7cefc15332d5cdb45c2a993506",
  "result": {
    "markdown": "---\ntitle: \"Thinking About Hierarchical Variance Parameters\"\ndate: 2023-06-29\ntwitter-card:\n  image: \"index_files/figure-html/fig-low-fit-1.png\"\nopen-graph:\n  image: \"index_files/figure-html/fig-low-fit-1.png\"\n---\n\n\nI'm still thinking about priors, distributions, and logistic regressions. The fact that a fairly broad normal distribution in logit space turns into a bimodal distribution in probability space has got me thinking about the standard deviation of random effects in logistic regression. Specifically, what happens in cases where the population of individuals may be bimodal\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"setup\"}\nlibrary(tidyverse)\nlibrary(brms)\nlibrary(tidybayes)\nlibrary(marginaleffects)\n\nlibrary(gt)\n\nsource(here::here(\"_defaults.R\"))\n\nseed <- 2023-6-29\n\nset.seed(seed)\n```\n:::\n\n\n## Simulating some data\n\nI'll kick things off with simulating some data. Our predictor variable will be just randomly sampled from \\~normal(0,1), so it'll handily already be z-scored. I'll also go for a slope in logit space of 1, so logit(y) = x.\n\nI'll treat each point I've sampled for X as belonging to an individual, or subject, grouping variable, and each individual's personal probability will be sampled from a beta distribution. I'll simulate two possibilities here, one where individuals are kind of closely clustered near each other, and another where they're pretty strongly bifurcated close to 0 and 1.[^1]\n\n[^1]: I initially also tried simulating a case where individuals were strictly categorical based on the probability associated with their x, and things did *not* go well for the models.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"simulation of individuals\"}\ntibble(\n  x = rnorm(100),\n  logit = x,\n  prob = plogis(logit)\n) |> \n  mutate(\n    individual = row_number(),\n    subj_prob_low = rbeta(\n      n = n(), \n      prob * 0.25, \n      (1-prob) * 0.25\n    ),\n    subj_prob_high = rbeta(\n      n = n(), \n      prob * 7, \n      (1-prob) * 7\n      )\n  )->\n  sim_params\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plotting code\"}\nsim_params |> \n  pivot_longer(\n    starts_with(\"subj_prob\")\n  ) |> \n  mutate(\n    name = case_when(\n      name == \"subj_prob_high\" ~ \"unimodal\",\n      name == \"subj_prob_low\" ~ \"bifurcated\"\n    )\n  ) |> \n  ggplot(aes(x, value))+\n    geom_point()+\n    labs(title = \"subject-level probabilities\",\n         y = \"prob\")+\n    scale_x_continuous(\n      breaks = seq(-2,2, by = 2)\n    ) +  \n    facet_wrap(~name)\n```\n\n::: {.cell-output-display}\n![Probabilities for individuals](index_files/figure-html/fig-individuals-1.png){#fig-individuals width=768}\n:::\n:::\n\n\nFor each of these probabilities, I'll simulate 50 binomial observations.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"simulating utterances\"}\nsim_params |> \n  rowwise() |> \n  mutate(\n    obs = list(tibble(\n      y_prob_low = rbinom(n = 50, size = 1, prob = subj_prob_low),\n      y_prob_high = rbinom(n = 50, size = 1, prob = subj_prob_high)\n    ))\n  ) |> \n  unnest(obs) ->\n  sim_obs\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plotting code\"}\nsim_obs |> \n  pivot_longer(\n    starts_with(\"y_\"),\n    names_to = \"simulation\",\n    values_to = \"observation\"\n  ) |> \n  mutate(\n    simulation = case_when(\n      simulation == \"y_prob_high\" ~ \"unimodal\",\n      simulation == \"y_prob_low\" ~ \"bifurcated\"\n    )\n  ) |> \n  ggplot(aes(x, factor(observation))) +\n    stat_sum(alpha = 0.3)+\n    labs(title = \"simulated observations\")+\n    scale_x_continuous(\n      breaks = seq(-2,2, by = 2)\n    ) +\n    facet_wrap(~simulation)\n```\n\n::: {.cell-output-display}\n![simulated observations](index_files/figure-html/fig-obs-1.png){#fig-obs width=768}\n:::\n:::\n\n\n## Looking at the default priors\n\nIf we take a look at the default priors a logistic model would get in `{brms}`, we can see that both the Intercept and the slope get pretty broad priors (the blank prior for the slope means it's a flat prior).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_prior(\n  bf(y_prob_low ~ x + (1|individual)),\n  data = sim_obs,\n  family = bernoulli(link = \"logit\")\n) |> \n  as_tibble() |> \n  select(prior, class, coef, group) |> \n  gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"mxdyaphpjk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mxdyaphpjk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mxdyaphpjk thead, #mxdyaphpjk tbody, #mxdyaphpjk tfoot, #mxdyaphpjk tr, #mxdyaphpjk td, #mxdyaphpjk th {\n  border-style: none;\n}\n\n#mxdyaphpjk p {\n  margin: 0;\n  padding: 0;\n}\n\n#mxdyaphpjk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mxdyaphpjk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mxdyaphpjk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mxdyaphpjk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mxdyaphpjk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mxdyaphpjk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mxdyaphpjk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mxdyaphpjk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mxdyaphpjk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mxdyaphpjk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mxdyaphpjk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mxdyaphpjk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mxdyaphpjk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mxdyaphpjk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mxdyaphpjk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mxdyaphpjk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mxdyaphpjk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mxdyaphpjk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mxdyaphpjk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mxdyaphpjk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mxdyaphpjk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mxdyaphpjk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mxdyaphpjk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mxdyaphpjk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mxdyaphpjk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mxdyaphpjk .gt_left {\n  text-align: left;\n}\n\n#mxdyaphpjk .gt_center {\n  text-align: center;\n}\n\n#mxdyaphpjk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mxdyaphpjk .gt_font_normal {\n  font-weight: normal;\n}\n\n#mxdyaphpjk .gt_font_bold {\n  font-weight: bold;\n}\n\n#mxdyaphpjk .gt_font_italic {\n  font-style: italic;\n}\n\n#mxdyaphpjk .gt_super {\n  font-size: 65%;\n}\n\n#mxdyaphpjk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mxdyaphpjk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mxdyaphpjk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mxdyaphpjk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mxdyaphpjk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mxdyaphpjk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mxdyaphpjk .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"prior\">prior</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"class\">class</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"coef\">coef</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"group\">group</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\"></td>\n<td headers=\"class\" class=\"gt_row gt_left\">b</td>\n<td headers=\"coef\" class=\"gt_row gt_left\"></td>\n<td headers=\"group\" class=\"gt_row gt_left\"></td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\"></td>\n<td headers=\"class\" class=\"gt_row gt_left\">b</td>\n<td headers=\"coef\" class=\"gt_row gt_left\">x</td>\n<td headers=\"group\" class=\"gt_row gt_left\"></td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">student_t(3, 0, 2.5)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">Intercept</td>\n<td headers=\"coef\" class=\"gt_row gt_left\"></td>\n<td headers=\"group\" class=\"gt_row gt_left\"></td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\">student_t(3, 0, 2.5)</td>\n<td headers=\"class\" class=\"gt_row gt_left\">sd</td>\n<td headers=\"coef\" class=\"gt_row gt_left\"></td>\n<td headers=\"group\" class=\"gt_row gt_left\"></td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\"></td>\n<td headers=\"class\" class=\"gt_row gt_left\">sd</td>\n<td headers=\"coef\" class=\"gt_row gt_left\"></td>\n<td headers=\"group\" class=\"gt_row gt_left\">individual</td></tr>\n    <tr><td headers=\"prior\" class=\"gt_row gt_left\"></td>\n<td headers=\"class\" class=\"gt_row gt_left\">sd</td>\n<td headers=\"coef\" class=\"gt_row gt_left\">Intercept</td>\n<td headers=\"group\" class=\"gt_row gt_left\">individual</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nIf we real quick look at how the prior on the intercept plays out in the probability space, we get one of these bimodal distributions.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plotting code\"}\ntibble(\n  x = rstudent_t(1e6, df = 3, sigma = 2.5)\n) |> \n  ggplot(aes(plogis(x))) +\n    stat_slab(fill = ptol_red)+\n    theme_no_y()+\n    scale_y_continuous(\n      expand = expansion(mult = 0)\n    )+\n    labs(title = \"invlogit(student_t(3, 0, 2.5))\",\n         x = NULL)\n```\n\n::: {.cell-output-display}\n![Student-t prior in the probability space.](index_files/figure-html/fig-intercept-1.png){#fig-intercept width=768}\n:::\n:::\n\n\nSo, for the intercept and slope priors, I'll adjust them to be \\~normal(0, 1.5) and \\~normal(0,1), respectively.\n\n## Actually fitting the models.\n\n### Bimodal population\n\nFirst, here's the model for the population where individuals' probabilities were squished out towards 0 and 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlow_mod <- brm(\n  y_prob_low ~ x + (1|individual),\n  data = sim_obs,\n  family = bernoulli(link = \"logit\"),\n  prior = c(\n    prior(normal(0,1.5), class = \"Intercept\"),\n    prior(normal(0,1), class = \"b\", coef = \"x\")\n  ),\n  cores = 4, \n  seed = seed,  \n  backend = \"cmdstanr\",\n  file = \"low_mod.RDS\"\n) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"summary table\"}\nlow_mod |> \n  gather_draws(\n    `sd_.*`,\n    `b_.*`,\n    regex = T\n  ) |> \n  mean_hdci() |> \n  select(.variable, .value, .lower, .upper) |> \n  gt() |> \n  fmt_number()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"qwckqkmnoy\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qwckqkmnoy table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qwckqkmnoy thead, #qwckqkmnoy tbody, #qwckqkmnoy tfoot, #qwckqkmnoy tr, #qwckqkmnoy td, #qwckqkmnoy th {\n  border-style: none;\n}\n\n#qwckqkmnoy p {\n  margin: 0;\n  padding: 0;\n}\n\n#qwckqkmnoy .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qwckqkmnoy .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qwckqkmnoy .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qwckqkmnoy .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qwckqkmnoy .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qwckqkmnoy .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qwckqkmnoy .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qwckqkmnoy .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qwckqkmnoy .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qwckqkmnoy .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qwckqkmnoy .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qwckqkmnoy .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qwckqkmnoy .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qwckqkmnoy .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qwckqkmnoy .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwckqkmnoy .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qwckqkmnoy .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qwckqkmnoy .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qwckqkmnoy .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwckqkmnoy .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qwckqkmnoy .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwckqkmnoy .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qwckqkmnoy .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwckqkmnoy .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qwckqkmnoy .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qwckqkmnoy .gt_left {\n  text-align: left;\n}\n\n#qwckqkmnoy .gt_center {\n  text-align: center;\n}\n\n#qwckqkmnoy .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qwckqkmnoy .gt_font_normal {\n  font-weight: normal;\n}\n\n#qwckqkmnoy .gt_font_bold {\n  font-weight: bold;\n}\n\n#qwckqkmnoy .gt_font_italic {\n  font-style: italic;\n}\n\n#qwckqkmnoy .gt_super {\n  font-size: 65%;\n}\n\n#qwckqkmnoy .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qwckqkmnoy .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qwckqkmnoy .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qwckqkmnoy .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qwckqkmnoy .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qwckqkmnoy .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qwckqkmnoy .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".variable\">.variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".value\">.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".lower\">.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".upper\">.upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\".variable\" class=\"gt_row gt_left\">b_Intercept</td>\n<td headers=\".value\" class=\"gt_row gt_right\">0.60</td>\n<td headers=\".lower\" class=\"gt_row gt_right\">−1.04</td>\n<td headers=\".upper\" class=\"gt_row gt_right\">2.13</td></tr>\n    <tr><td headers=\".variable\" class=\"gt_row gt_left\">b_x</td>\n<td headers=\".value\" class=\"gt_row gt_right\">3.01</td>\n<td headers=\".lower\" class=\"gt_row gt_right\">1.62</td>\n<td headers=\".upper\" class=\"gt_row gt_right\">4.36</td></tr>\n    <tr><td headers=\".variable\" class=\"gt_row gt_left\">sd_individual__Intercept</td>\n<td headers=\".value\" class=\"gt_row gt_right\">7.85</td>\n<td headers=\".lower\" class=\"gt_row gt_right\">5.85</td>\n<td headers=\".upper\" class=\"gt_row gt_right\">10.21</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThings have kind of clearly gone off the rails here. The intercepts and slopes are all over the place, but that's maybe not surprising given the trade offs the model is making between the population level slopes and the individual level probabilities. It's worth noting that this model had no diagnostic warnings and was well converged.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plotting code\"}\nlow_mod |> \n  predictions(\n    newdata = datagrid(x = seq(-3, 3, length = 100)),\n    re_formula = NA\n  ) |>\n  posterior_draws() |> \n  ggplot(aes(x, draw)) +\n    stat_lineribbon(linewidth = 0.5)+\n    scale_fill_brewer() +\n    labs(\n      title = \"Bifurcated population\",\n      y = \"prob\"\n    )\n```\n\n::: {.cell-output-display}\n![The posterior fitted values.](index_files/figure-html/fig-low-fit-1.png){#fig-low-fit width=768}\n:::\n:::\n\n\nIn fact, that posterior distribution for the between-speaker sd is very extreme at about 8. If we plot the kind of distribution of individuals it suggests when the population level probability = 0.5, we get those steep walls near 0 and 1 again.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plotting code\"}\nlow_mod |> \n  gather_draws(\n    `sd_.*`,\n    regex = T\n  ) |> \n  slice_sample(\n    n = 10\n  ) |> \n  rowwise() |> \n  mutate(\n    individuals = list(tibble(\n      individual = rnorm(1e5, mean = 0, sd=.value)\n    ))\n  ) |> \n  unnest(individuals) |> \n  ggplot(aes(plogis(individual)))+\n    stat_slab(\n      aes(group = factor(.value)),\n      linewidth = 0.5,\n      fill = NA,\n      color = ptol_red\n    ) +\n    scale_y_continuous(expand = expansion(mult = 0))+\n    labs(\n      title = \"Random intercepts distribution around 0.5\"\n    )+\n    theme_no_y()\n```\n\n::: {.cell-output-display}\n![Implied distribution of individuals in the bifircated population.](index_files/figure-html/fig-bif-sd-1.png){#fig-bif-sd width=768}\n:::\n:::\n\n\n### The Unimodal Population\n\nLet's do it all again, but now for the population where individuals' probabilities were clustered around the population probability.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhigh_mod <- brm(\n  y_prob_high ~ x + (1|individual),\n  data = sim_obs,\n  family = bernoulli(link = \"logit\"),\n  prior = c(\n    prior(normal(0,1.5), class = \"Intercept\"),\n    prior(normal(0,1), class = \"b\", coef = \"x\")\n  ),\n  cores = 4,\n  adapt_delta = 0.9,\n  seed = seed,\n  backend = \"cmdstanr\",\n  file = \"high_mod.RDS\"\n) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"summary table\"}\nhigh_mod |> \n  gather_draws(\n    `sd_.*`,\n    `b_.*`,\n    regex = T\n  ) |> \n  mean_hdci() |> \n  select(\n    .variable, .value, .lower, .upper\n  ) |> \n  gt() |> \n   fmt_number(decimals = 2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"agbghbcqxh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#agbghbcqxh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#agbghbcqxh thead, #agbghbcqxh tbody, #agbghbcqxh tfoot, #agbghbcqxh tr, #agbghbcqxh td, #agbghbcqxh th {\n  border-style: none;\n}\n\n#agbghbcqxh p {\n  margin: 0;\n  padding: 0;\n}\n\n#agbghbcqxh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#agbghbcqxh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#agbghbcqxh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#agbghbcqxh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#agbghbcqxh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#agbghbcqxh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#agbghbcqxh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#agbghbcqxh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#agbghbcqxh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#agbghbcqxh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#agbghbcqxh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#agbghbcqxh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#agbghbcqxh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#agbghbcqxh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#agbghbcqxh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agbghbcqxh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#agbghbcqxh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#agbghbcqxh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#agbghbcqxh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agbghbcqxh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#agbghbcqxh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agbghbcqxh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#agbghbcqxh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agbghbcqxh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#agbghbcqxh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#agbghbcqxh .gt_left {\n  text-align: left;\n}\n\n#agbghbcqxh .gt_center {\n  text-align: center;\n}\n\n#agbghbcqxh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#agbghbcqxh .gt_font_normal {\n  font-weight: normal;\n}\n\n#agbghbcqxh .gt_font_bold {\n  font-weight: bold;\n}\n\n#agbghbcqxh .gt_font_italic {\n  font-style: italic;\n}\n\n#agbghbcqxh .gt_super {\n  font-size: 65%;\n}\n\n#agbghbcqxh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#agbghbcqxh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#agbghbcqxh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#agbghbcqxh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#agbghbcqxh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#agbghbcqxh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#agbghbcqxh .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".variable\">.variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".value\">.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".lower\">.lower</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\".upper\">.upper</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\".variable\" class=\"gt_row gt_left\">b_Intercept</td>\n<td headers=\".value\" class=\"gt_row gt_right\">−0.06</td>\n<td headers=\".lower\" class=\"gt_row gt_right\">−0.23</td>\n<td headers=\".upper\" class=\"gt_row gt_right\">0.10</td></tr>\n    <tr><td headers=\".variable\" class=\"gt_row gt_left\">b_x</td>\n<td headers=\".value\" class=\"gt_row gt_right\">1.05</td>\n<td headers=\".lower\" class=\"gt_row gt_right\">0.87</td>\n<td headers=\".upper\" class=\"gt_row gt_right\">1.22</td></tr>\n    <tr><td headers=\".variable\" class=\"gt_row gt_left\">sd_individual__Intercept</td>\n<td headers=\".value\" class=\"gt_row gt_right\">0.77</td>\n<td headers=\".lower\" class=\"gt_row gt_right\">0.63</td>\n<td headers=\".upper\" class=\"gt_row gt_right\">0.91</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nThe intercepts and slope posteriors are much more tight, and the inter-speaker sd posterior is \\<1.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plottng code\"}\nhigh_mod |> \n  predictions(\n    newdata = datagrid(x = seq(-3, 3, length = 100)),\n    re_formula = NA\n  ) |> \n  posterior_draws() |> \n  ggplot(aes(x, draw)) +\n    stat_lineribbon(linewidth = 0.5)+\n    scale_fill_brewer()+\n    labs(\n      title = \"Unimodal population\",\n      y = \"prob\"\n    )\n```\n\n::: {.cell-output-display}\n![Posterior fitted values for the unimodal population.](index_files/figure-html/fig-unimodal-fit-1.png){#fig-unimodal-fit width=768}\n:::\n:::\n\n\nLet's look at the implied individual level distribution around 0.5.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"plotting code\"}\nhigh_mod |> \n  gather_draws(\n    `sd_.*`,\n    regex = T\n  ) |> \n  slice_sample(\n    n = 20\n  ) |> \n  rowwise() |> \n  mutate(\n    individuals = list(tibble(\n      individual = rnorm(1e5, mean = 0, sd=.value)\n    ))\n  ) |> \n  unnest(individuals) |> \n  ggplot(aes(plogis(individual)))+\n    stat_slab(\n      aes(group = factor(.value)),\n      linewidth = 0.5,\n      fill = NA,\n      color = ptol_red\n    ) +\n    scale_y_continuous(expand = expansion(mult = 0))+\n    labs(\n      title = \"Random intercepts distribution around 0.5\"\n    )+\n    theme_no_y()\n```\n\n::: {.cell-output-display}\n![Implied distribution of individuals in the unimodal population.](index_files/figure-html/fig-uni-sd-1.png){#fig-uni-sd width=768}\n:::\n:::\n\n\n## The Upshot\n\nEven though I've fit and looked at hierarchical logistic regressions before, I hadn't stopped to think about how to interpret the standard deviation of the random intercepts before. If you'd asked me before what a large sd implied about the distribution of individuals in the probability space, I think I would have said they'd be more *uniformly* distributed, but actually it means they're more *bifurcated*!\n\nAlso, if you've got a fairly bifurcated population, the population level estimates are going to get pretty wonky.\n\nAll food for thought moving forward.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}